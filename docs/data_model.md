## Conventions

- All tables will have an autogenerated primary key called `id`.

## User Management

The system separates users (account holders) from hafizs (memorizers) to support complex family and educational scenarios:

- A single user might have more than 1 hafiz under him/her. For example, Fatima has 3 hafiz accounts for her memorising children and one for herself.
- Zainab, the teenage daughter of Fatima, has independent access to her account with her own login - but she can access data of her sibling as well.
- Both parents might need access to a child's account
- To enable all these scenarios, users and hafizs tables are individual tables with the many-to-many relationship stored in an association table hafizs_users

### Tables

#### users table
Account holders who can log in and access the system.

- name
- email: Unique across the system, used for authentication and notifications
- password: Encrypted password for login
- role: Primary role of the user 
  - values: hafiz, parent, teacher, parent_hafiz

#### hafizs table
Individual memorizers whose progress is tracked, regardless of who manages their account.

- name
<!-- - age_group: Age category for appropriate content and expectations -->
- daily_capacity: How many pages they can revise per day - upper limit for suggested revision plan
- current_date: Current date context for the hafiz's progress tracking
- display_count: Number of items to display in UI (default: 5)

#### hafizs_users table
Defines which users can access which hafiz accounts and their relationship.

- hafiz_id
- user_id
- relationship: How user relates to hafiz
  - values: self, parent, teacher, sibling
- granted_by_user_id: User who established this relationship
- granted_at: Timestamp when relationship was established

## Content Structure

### Tables

#### mushafs table
Different versions/editions of the Quran with their layout specifications.

- name: Name of the mushaf (e.g., "Madinah Mushaf", "Uthmani Script")
- description: Detailed description of the mushaf
- total_pages: Total number of pages in this mushaf
- lines_per_page: Standard number of lines per page

#### surahs table
Quranic chapters (surahs) reference data.

- number: Surah number (1-114)
- name: Name of the surah
- total_ayat: Total number of verses in the surah

#### pages table
Individual pages within a mushaf with their structural information.

- mushaf_id
- page_number
- juz_number
- start_text: starting three words of the page (e.g., "الْحَمْدُ لِلَّهِ رَبِّ", "الم ذَلِكَ الْكِتَابُ")
<!-- - starting_verse: First verse reference on the page -->
<!-- - ending_verse: Last verse reference on the page -->
- multiple_surahs: Boolean indicating if page contains multiple surahs

#### items table
Memorizable units that can be tracked individually (pages, verses, sections).

- item_type: Type of memorizable unit
  - values: page, page-part	, surah
- surah_id
- surah_name
- page_id
- part: To identifies how many surahs are in the page
  - values: 1.0, 2.0, 3.0 
- start_text
- lines: line range of the item or part (e.g., "2-8", "1-15")
- part_type: Classification of the part type
  - values: standard
- hafiz_id
- active: Boolean indicating if item is currently active for memorization
- description: description about the item (e.g., "1 Fatihah Juz 1 Start", "2 Baqarah Start")

#### modes table
Different modes of memorization practice (e.g., New Memorization, Daily, Weekly, Monthly, SRS).

- name
- description

#### srs_booster_pack table
Spaced Repetition System configurations for different difficulty levels.

- name
- description
- start_interval: Initial interval in days
- end_interval: Final interval in days
- interval_days: comma-separated list of interval progression

#### plans table
Memorization plans for monthly mode.

- hafiz_id
- start_date: Plan start date
- end_date: Plan completion date
- start_page: Starting page number for the plan
- end_page: Ending page number for the plan
- revision_count: Total number of revisions in the plan
- page_count: Total number of pages in the plan
- completed: Boolean indicating if plan is completed

## Memorization Tracking

### Tables

#### hafizs_items table
Junction table tracking the relationship between hafizs and their assigned items with memorization status.

- hafiz_id
- item_id
- page_number
- status: Current memorization status of this item
  - values: memorized, newly_memorized, Null(not_memorized)
- mode_id
- next_review: Date when this item should be reviewed next
- last_review: Date when this item was last reviewed
- watch_list_graduation_date: Date when item graduated from watch list
- srs_booster_pack_id
- good_streak: Count of consecutive successful reviews
- bad_streak: Count of consecutive failed reviews
- last_interval: Previous planned interval duration in days 
- current_interval: Actual interval duration in days
- next_interval: Calculated interval for next review in days
- srs_start_date: Date when SRS tracking began for this item
- good_count: Total count of successful reviews
- bad_count: Total count of failed reviews
- score: Sum of the ratings
- count: Total number of reviews for this item


#### revisions table
Individual revision sessions and their outcomes.

- hafiz_id
- item_id
- revision_date: Date when revision took place
- rating: Performance rating for this revision
  - values: -1(Bad), 0(Ok), 1(Bad)
- mode_id
- plan_id
<!-- - notes: Additional notes about the revision session -->
- last_interval: Previous planned interval duration in days
- current_interval: Actual interval duration in days
- next_interval: Calculated interval for next revision in days
